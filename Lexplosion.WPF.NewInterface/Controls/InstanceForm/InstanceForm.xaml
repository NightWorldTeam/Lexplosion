<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Lexplosion.WPF.NewInterface.Controls"
    xmlns:converters="clr-namespace:Lexplosion.WPF.NewInterface.Core.Converters"
    xmlns:core="clr-namespace:Lexplosion.WPF.NewInterface.Core"
    xmlns:extensions="clr-namespace:Lexplosion.WPF.NewInterface.Extensions"
    xmlns:local="clr-namespace:Lexplosion.WPF.NewInterface.Controls"
    xmlns:objects="clr-namespace:Lexplosion.Logic.Objects;assembly=Lexplosion.Core"
    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <ControlTemplate x:Key="DropDownButton" TargetType="{x:Type controls:AdvancedButton}">
        <Border
            x:Name="border"
            Margin="1"
            Padding="5,2,5,2"
            Background="Transparent"
            CornerRadius="5">

            <Grid Margin="5,3,5,3" ShowGridLines="False">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Border
                    Padding="2"
                    Background="Transparent"
                    CornerRadius="5">
                    <Viewbox Width="20" Height="20">
                        <Path
                            x:Name="Path"
                            HorizontalAlignment="Center"
                            extensions:PathExtensions.StringData="{TemplateBinding IconData}"
                            Fill="{DynamicResource PrimaryForegroundSolidColorBrush}"
                            Stretch="Fill" />
                    </Viewbox>
                </Border>

                <TextBlock
                    x:Name="TextBlock"
                    Grid.Column="1"
                    Margin="7,0,5,0"
                    FontSize="12pt"
                    Foreground="{DynamicResource PrimaryForegroundSolidColorBrush}"
                    Text="{TemplateBinding Text}"
                    TextAlignment="Justify" />
            </Grid>
        </Border>

        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="border" Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.1" Color="{DynamicResource ActivityColor}" />
                    </Setter.Value>
                </Setter>
                <Setter TargetName="TextBlock" Property="TextElement.Foreground" Value="{DynamicResource ActivitySolidColorBrush}" />

                <Setter TargetName="Path" Property="Fill" Value="{DynamicResource ActivitySolidColorBrush}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!--<DataTemplate DataType="{x:Type local:}" />-->

    <Style x:Key="InstanceFormMainActionButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid>
                        <Border
                            x:Name="ActivityColorBorder"
                            Background="Transparent"
                            CornerRadius="0,5,0,0" />

                        <core:If Condition="{TemplateBinding Content, Converter={converters:IsValueNullConverter}}">
                            <core:If.True>

                                <Viewbox Width="24" Height="24">
                                    <Path
                                        x:Name="Icon"
                                        extensions:PathExtensions.StringKeyData="Download"
                                        Fill="{DynamicResource PrimaryForegroundSolidColorBrush}"
                                        Stretch="Fill" />
                                </Viewbox>
                            </core:If.True>
                            <core:If.False>

                                <!--  Percentages  -->
                                <TextBlock
                                    x:Name="Percentage"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="18"
                                    FontWeight="SemiBold"
                                    Foreground="{DynamicResource PrimaryForegroundSolidColorBrush}"
                                    Text="{TemplateBinding Content}" />
                            </core:If.False>
                        </core:If>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.3" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="ActivityColorBorder" Property="Background" Value="{DynamicResource ActivitySolidColorBrush}" />
                            <Setter TargetName="Icon" Property="Fill" Value="{DynamicResource BrandColorForegroundSolidColorBrush}" />
                            <Setter TargetName="Percentage" Property="Foreground" Value="{DynamicResource BrandColorForegroundSolidColorBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type local:InstanceForm}">
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:InstanceForm}">
                    <Border
                        Width="600"
                        Height="120"
                        Background="{DynamicResource PrimarySolidColorBrush}"
                        BorderBrush="{DynamicResource SeparateSolidColorBrush}"
                        BorderThickness="1"
                        CornerRadius="5">
                        <Grid HorizontalAlignment="Stretch" ShowGridLines="False">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="60" />
                            </Grid.ColumnDefinitions>

                            <!--  Left Block  -->
                            <Grid x:Name="PART_LogoBlock">
                                <!--  Avatar  -->
                                <!--  Circle loader here>???  -->
                                <Border
                                    x:Name="PART_Logo"
                                    Background="{DynamicResource ActivitySolidColorBrush}"
                                    CornerRadius="5" />


                                <!--  Update Button  -->
                                <Border
                                    x:Name="UpdateIndicator"
                                    Width="28"
                                    Height="28"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    CornerRadius="5,0,0,0">

                                    <Border.Background>
                                        <SolidColorBrush Opacity="0.5" Color="Black" />
                                    </Border.Background>

                                    <Viewbox Width="22" Height="22">
                                        <Path
                                            Data="M 24.15 42 q -3.75 0 -7.05 -1.425 T 11.325 36.7 q -2.475 -2.45 -3.9 -5.75 Q 6 27.65 6 23.9 t 1.425 -7 q 1.425 -3.25 3.9 -5.675 Q 13.8 8.8 17.1 7.4 Q 20.4 6 24.15 6 q 4 0 7.575 1.75 t 6.175 4.8 v -5.3 h 3 v 10.4 H 30.45 v -3 h 5.25 q -2.2 -2.55 -5.175 -4.1 Q 27.55 9 24.15 9 q -6.25 0 -10.7 4.275 Q 9 17.55 9 23.75 q 0 6.35 4.4 10.8 Q 17.8 39 24.15 39 q 6.25 0 10.55 -4.4 Q 39 30.2 39 23.95 h 3 q 0 7.5 -5.2 12.775 T 24.15 42 Z m 6.1 -9.85 l -7.7 -7.6 v -10.7 h 3 v 9.45 L 32.4 30 Z"
                                            Fill="{DynamicResource CheckBoxMarkSolidColorBrush}"
                                            Stretch="Fill" />
                                    </Viewbox>
                                </Border>

                                <!--  Modloader Icon  -->
                                <Border
                                    x:Name="ModloaderIcon"
                                    Width="28"
                                    Height="28"
                                    Padding="6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    CornerRadius="0,5,0,5"
                                    ToolTip="Neoforge">

                                    <Border.Background>
                                        <SolidColorBrush Opacity="0" Color="Black" />
                                    </Border.Background>
                                </Border>

                                <!--  More Button  -->
                                <Grid Opacity="0">
                                    <Border CornerRadius="5">
                                        <Border.Background>
                                            <SolidColorBrush Opacity="0.5" Color="Black" />
                                        </Border.Background>
                                        <Border.Effect>
                                            <BlurEffect Radius="0" />
                                        </Border.Effect>
                                    </Border>


                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        extensions:TextBlockExtensions.TextByKey="More"
                                        FontSize="22"
                                        FontWeight="Bold"
                                        Foreground="{DynamicResource CheckBoxMarkSolidColorBrush}" />

                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    To="1"
                                                                    Duration="0:0:0.35" />

                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    To="1"
                                                                    Duration="0:0:0.35" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                    <Trigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Opacity"
                                                                    To="0"
                                                                    Duration="0:0:0.35" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.ExitActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>
                                </Grid>
                            </Grid>

                            <!--  Center Block  -->
                            <Grid
                                Grid.Column="1"
                                Margin="8,0"
                                ShowGridLines="False">

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <!--  Name and Author  -->
                                <Grid Margin="0,0,0,2">

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        x:Name="PART_Name"
                                        Margin="0,4,0,0"
                                        FontSize="20"
                                        Foreground="{DynamicResource PrimaryForegroundSolidColorBrush}"
                                        Text="Instance Name"
                                        TextTrimming="CharacterEllipsis" />

                                    <TextBlock
                                        x:Name="PART_Author"
                                        Grid.Column="1"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource SecondaryForegroundSolidColorBrush}"
                                        Text="by AuthorName" />
                                </Grid>

                                <!--  TODO сделать адаптив для описания  -->
                                <TextBlock
                                    x:Name="PART_Description"
                                    Grid.Row="1"
                                    Margin="0,0,0,4"
                                    FontSize="16"
                                    Foreground="{DynamicResource SecondaryForegroundSolidColorBrush}"
                                    TextTrimming="WordEllipsis"
                                    TextWrapping="WrapWithOverflow" />

                                <!--  Tags  -->
                                <ItemsControl
                                    x:Name="PART_TagsPanel"
                                    Grid.Row="2"
                                    Margin="0,0,0,4">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate DataType="{x:Type objects:CategoryBase}">
                                            <!--  В будущем кнопки наверное  -->
                                            <Border
                                                Margin="0,2,3,0"
                                                Padding="8,4"
                                                Background="{DynamicResource TagsColorBrush}"
                                                CornerRadius="5">
                                                <TextBlock
                                                    FontSize="14"
                                                    Foreground="{DynamicResource PrimaryForegroundSolidColorBrush}"
                                                    Text="{Binding Name}" />
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                    <!--  Tags ItemsPanel  -->
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>

                                <TextBlock
                                    x:Name="PART_FilesCountLabel"
                                    Grid.Row="2"
                                    Margin="0,0,8,8"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    FontSize="14"
                                    Foreground="{DynamicResource SecondaryForegroundSolidColorBrush}" />

                                <ProgressBar
                                    x:Name="PART_ProgressBar"
                                    Grid.Row="3"
                                    Height="5"
                                    Margin="-8,0,-8,0" />
                            </Grid>

                            <!--  Right Block - Buttons  -->
                            <Grid Grid.Column="2" ShowGridLines="False">

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Button x:Name="PART_MainActionButton" Style="{StaticResource InstanceFormMainActionButtonStyle}">
                                    <!--<Button.CacheMode>
                                        <BitmapCache />
                                    </Button.CacheMode>-->
                                </Button>

                                <controls:DropdownMenu
                                    x:Name="PART_DropDownMenu"
                                    Grid.Row="1"
                                    Background="{DynamicResource PrimarySolidColorBrush}"
                                    BorderBrush="{DynamicResource SeparateSolidColorBrush}"
                                    BorderThickness="1">
                                    <StackPanel>

                                        <core:If Condition="{Binding IsDownloading}">
                                            <core:If.True>

                                                <!--  Отмена скачивания  -->
                                                <controls:AdvancedButton
                                                    x:Name="CancelDownloadButton"
                                                    IconData="{DynamicResource PDCancel}"
                                                    Template="{StaticResource DropDownButton}"
                                                    Text="{DynamicResource CancelDownload}" />

                                            </core:If.True>
                                        </core:If>
                                        <core:If Condition="{Binding IsLocal}">
                                            <core:If.False>

                                                <!--  Посетить сайт  -->
                                                <controls:AdvancedButton x:Name="VisitWebsiteButton" Template="{StaticResource DropDownButton}" />

                                            </core:If.False>
                                        </core:If>

                                        <core:If Condition="{Binding InLibrary}">
                                            <core:If.True>
                                                <StackPanel>

                                                    <!--  Открыть папку  -->
                                                    <controls:AdvancedButton
                                                        x:Name="OpenFolderButton"
                                                        IconData="{DynamicResource PDFolder}"
                                                        Template="{StaticResource DropDownButton}"
                                                        Text="{DynamicResource OpenFolder}" />

                                                    <!--  Экспорт  -->
                                                    <controls:AdvancedButton
                                                        x:Name="ExportButton"
                                                        IconData="{DynamicResource PDExport}"
                                                        Template="{StaticResource DropDownButton}"
                                                        Text="{DynamicResource Export}" />

                                                    <!--  Дополнения  -->
                                                    <controls:AdvancedButton
                                                        x:Name="OpenAddonManagerButton"
                                                        IconData="{DynamicResource PDAddons}"
                                                        Template="{StaticResource DropDownButton}"
                                                        Text="{DynamicResource Addons}" />

                                                    <core:If Condition="{Binding IsInstalled}">
                                                        <core:If.True>

                                                            <!--  Удалить  -->
                                                            <controls:AdvancedButton
                                                                x:Name="DeleteButton"
                                                                IconData="{DynamicResource PDDelete}"
                                                                Template="{StaticResource DropDownButton}"
                                                                Text="{DynamicResource DeleteInstance}" />

                                                        </core:If.True>
                                                        <core:If.False>

                                                            <!--  Удалить из библиотеки  -->
                                                            <controls:AdvancedButton
                                                                x:Name="DeleteFromLibraryButton"
                                                                IconData="{DynamicResource PDDelete}"
                                                                Template="{StaticResource DropDownButton}"
                                                                Text="{DynamicResource RemoveFromLibrary}" />

                                                        </core:If.False>
                                                    </core:If>
                                                </StackPanel>
                                            </core:If.True>
                                            <core:If.False>

                                                <!--  Добавить в библиотеку  -->
                                                <controls:AdvancedButton
                                                    x:Name="AddToLibraryButton"
                                                    IconData="{DynamicResource PDAddToLibrary}"
                                                    Template="{StaticResource DropDownButton}"
                                                    Text="{DynamicResource AddToLibrary}" />

                                            </core:If.False>
                                        </core:If>
                                    </StackPanel>
                                </controls:DropdownMenu>
                            </Grid>
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>